---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const books = await getCollection('books');

// 専用ページがあるものはそちらにリンク
const getBookUrl = (bookId: string) => {
  // .mdを除去
  const id = bookId.replace(/\.md$/, '');
  const customPages: Record<string, string> = {
    'shushin': '/books/shushin',
  };
  return customPages[id] || `/books/${id}`;
};
---

<Layout title="読書記録">
  <div class="space-y-8">
    <section>
      <h1 class="text-3xl font-bold text-gray-900 mb-4">読書記録</h1>
      <p class="text-gray-600">
        読んだ本の内容を自分なりに理解し、他者に説明できる形でまとめています。
      </p>
    </section>

    <section>
      <h2 class="text-xl font-semibold text-gray-800 mb-4">本の一覧</h2>
      <div class="grid gap-4">
        {books.map((book) => (
          <a
            href={getBookUrl(book.id)}
            class="block p-6 bg-white rounded-lg border border-gray-200 hover:border-gray-300 hover:shadow-sm transition-all"
          >
            <div class="flex justify-between items-start">
              <div>
                <h3 class="text-lg font-semibold text-gray-900">{book.data.title}</h3>
                <p class="text-gray-600 mt-1">{book.data.author}</p>
              </div>
              <span class={`text-xs px-2 py-1 rounded ${
                book.data.status === '読了'
                  ? 'bg-green-100 text-green-800'
                  : 'bg-yellow-100 text-yellow-800'
              }`}>
                {book.data.status}
              </span>
            </div>
          </a>
        ))}
      </div>
    </section>
  </div>
</Layout>
